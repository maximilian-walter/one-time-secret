(self.webpackChunkmaximilian_walter_one_time_secret=self.webpackChunkmaximilian_walter_one_time_secret||[]).push([[143],{3835:function(e,t,r){"use strict";r(3964);const a=document.body.dataset.baseUri,n=document.body.dataset.csrfToken;var o=r(3416),c=(r(752),r(9211),r(8607),r(9943),r(1638),r(3356),r(1354)),s=r.n(c);const i={mode:s().mode.CFB,padding:s().pad.NoPadding};function d(e){return e.toString(16).padStart(2,"0")}function l(e,t){return s().AES.encrypt(e,t,i).toString()}var u=r(640),f=r.n(u);const h=document.querySelector('[data-widget="create-secret-form"]');if(h){var v;const e=JSON.parse(null!==(v=h.dataset.labels)&&void 0!==v?v:"{}"),t=h.querySelector('[data-target="create-secret-form.form"]'),r=h.querySelector('[data-target="create-secret-form.result"]'),c=h.querySelector('[data-target="create-secret-form.link"]'),s=h.querySelector('[data-target="create-secret-form.copy"]');t&&t.addEventListener("submit",(async s=>{if(s.preventDefault(),t.checkValidity()){const s=(0,o.x0)(16),f=function(){const e=new Uint8Array(24);return window.crypto.getRandomValues(e),Array.from(e,d).join("")}(),h={id:s,secret:l(t.querySelector("textarea").value,f)},v=await fetch(a+"/api/secrets",{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":n},body:JSON.stringify(h)});if(201===v.status)r&&(r.hidden=!1),c&&(c.value=v.headers.get("Location")+"#"+encodeURIComponent(f),c.select());else if(429===v.status){var i;r&&(r.hidden=!0),alert(null!==(i=e.rateLimitReached)&&void 0!==i?i:"Please wait, you have reached the rate limit")}else{var u;r&&(r.hidden=!0),alert(null!==(u=e.error)&&void 0!==u?u:"Sorry, an error occurred")}}}),!1),c&&(c.addEventListener("focus",(()=>{c.select()}),!1),s&&s.addEventListener("click",(t=>{var r;t.preventDefault(),f()(c.value),alert(null!==(r=e.copied)&&void 0!==r?r:"Copied")}),!1))}const y=document.querySelector('[data-widget="show-secret"]');if(y){var m;const e=JSON.parse(null!==(m=y.dataset.labels)&&void 0!==m?m:"{}"),t=y.querySelector('[data-target="show-secret.show"]'),r=y.querySelector('[data-target="show-secret.result"]'),o=y.querySelector('[data-target="show-secret.error"]');t&&t.addEventListener("click",(async c=>{c.preventDefault();const d=await fetch(a+"/api/secrets/"+encodeURIComponent(y.dataset.id),{headers:{"X-Csrf-Token":n}});if(200===d.status){t.hidden=!0;const e=await d.json();try{const t=window.location.hash.substring(1),a=function(e,t){return s().AES.decrypt(e,t,i).toString(s().enc.Utf8)}(e.secret,t);r&&(r.hidden=!1,r.value=a)}catch(e){o&&(o.hidden=!1)}}else if(429===d.status){var l;r&&(r.hidden=!0),alert(null!==(l=e.rateLimitReached)&&void 0!==l?l:"Please wait, you have reached the rate limit")}else{var u;alert(null!==(u=e.error)&&void 0!==u?u:"Sorry, an error occurred")}})),r&&r.addEventListener("focus",(()=>{r.select()}),!1)}},2480:function(){}},function(e){e.O(0,[138],(function(){return t=3835,e(e.s=t);var t}));e.O()}]);