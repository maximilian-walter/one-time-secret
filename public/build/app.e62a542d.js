(self.webpackChunkmaximilian_walter_one_time_secret=self.webpackChunkmaximilian_walter_one_time_secret||[]).push([[143],{6551:function(e,t,r){"use strict";r(8674);var a=r(3416),n=(r(6992),r(9575),r(2472),r(3105),r(3462),r(3824),r(1354)),o=r.n(n);const c={mode:o().mode.CFB,padding:o().pad.NoPadding};function i(e){return e.toString(16).padStart(2,"0")}function s(e,t){return o().AES.encrypt(e,t,c).toString()}var d=r(640),l=r.n(d);const u=document.querySelector('[data-widget="create-secret-form"]');if(u){var f;const e=JSON.parse(null!==(f=u.dataset.labels)&&void 0!==f?f:"{}"),t=u.querySelector('[data-target="create-secret-form.form"]'),r=u.querySelector('[data-target="create-secret-form.result"]'),n=u.querySelector('[data-target="create-secret-form.link"]'),o=u.querySelector('[data-target="create-secret-form.copy"]');t&&t.addEventListener("submit",(async o=>{if(o.preventDefault(),t.checkValidity()){const o=(0,a.x0)(16),l=function(){const e=new Uint8Array(24);return window.crypto.getRandomValues(e),Array.from(e,i).join("")}(),u={id:o,secret:s(t.querySelector("textarea").value,l)},f=await fetch(APP_BASE_URI+"/api/secrets",{method:"POST",headers:{"Content-Type":"application/json","X-Csrf-Token":APP_CSRF_TOKEN},body:JSON.stringify(u)});if(201===f.status)r&&(r.hidden=!1),n&&(n.value=f.headers.get("Location")+"#"+encodeURIComponent(l),n.select());else if(429===f.status){var c;r&&(r.hidden=!0),alert(null!==(c=e.rateLimitReached)&&void 0!==c?c:"Please wait, you have reached the rate limit")}else{var d;r&&(r.hidden=!0),alert(null!==(d=e.error)&&void 0!==d?d:"Sorry, an error occurred")}}}),!1),n&&(n.addEventListener("focus",(()=>{n.select()}),!1),o&&o.addEventListener("click",(t=>{var r;t.preventDefault(),l()(n.value),alert(null!==(r=e.copied)&&void 0!==r?r:"Copied")}),!1))}const h=document.querySelector('[data-widget="show-secret"]');if(h){var v;const e=JSON.parse(null!==(v=h.dataset.labels)&&void 0!==v?v:"{}"),t=h.querySelector('[data-target="show-secret.show"]'),r=h.querySelector('[data-target="show-secret.result"]'),a=h.querySelector('[data-target="show-secret.error"]');t&&t.addEventListener("click",(async n=>{n.preventDefault();const i=await fetch(APP_BASE_URI+"/api/secrets/"+encodeURIComponent(h.dataset.id),{headers:{"X-Csrf-Token":APP_CSRF_TOKEN}});if(200===i.status){t.hidden=!0;const e=await i.json();try{const t=window.location.hash.substring(1),a=function(e,t){return o().AES.decrypt(e,t,c).toString(o().enc.Utf8)}(e.secret,t);r&&(r.hidden=!1,r.value=a)}catch(e){a&&(a.hidden=!1)}}else if(429===i.status){var s;r&&(r.hidden=!0),alert(null!==(s=e.rateLimitReached)&&void 0!==s?s:"Please wait, you have reached the rate limit")}else{var d;alert(null!==(d=e.error)&&void 0!==d?d:"Sorry, an error occurred")}})),r&&r.addEventListener("focus",(()=>{r.select()}),!1)}},2480:function(){}},function(e){e.O(0,[810],(function(){return t=6551,e(e.s=t);var t}));e.O()}]);